{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from\"react\";import{auth}from\"./auth\";import{onAuthStateChanged,getIdTokenResult}from\"firebase/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();// -------------------------------------------------\n// PROVIDER\n// -------------------------------------------------\nexport function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[role,setRole]=useState(null);// \"admin\" or \"user\"\nconst[loading,setLoading]=useState(true);useEffect(()=>{const unsub=onAuthStateChanged(auth,async firebaseUser=>{if(firebaseUser){// Load custom claims (admin role)\nconst token=await getIdTokenResult(firebaseUser);const isAdmin=token.claims.admin===true;setUser(firebaseUser);setRole(isAdmin?\"admin\":\"user\");}else{setUser(null);setRole(null);}setLoading(false);});return()=>unsub();},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,role,loading},children:!loading&&children});}// -------------------------------------------------\n// HOOK\n// -------------------------------------------------\nexport function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","auth","onAuthStateChanged","getIdTokenResult","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","role","setRole","loading","setLoading","unsub","firebaseUser","token","isAdmin","claims","admin","Provider","value","useAuth"],"sources":["C:/Users/Floyd/Desktop/Websites/HIAWTO/hi-awto-clean/src/firebase/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { auth } from \"./auth\";\r\nimport {\r\n  onAuthStateChanged,\r\n  getIdTokenResult,\r\n} from \"firebase/auth\";\r\n\r\nconst AuthContext = createContext();\r\n\r\n// -------------------------------------------------\r\n// PROVIDER\r\n// -------------------------------------------------\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [role, setRole] = useState(null); // \"admin\" or \"user\"\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, async (firebaseUser) => {\r\n      if (firebaseUser) {\r\n        // Load custom claims (admin role)\r\n        const token = await getIdTokenResult(firebaseUser);\r\n        const isAdmin = token.claims.admin === true;\r\n\r\n        setUser(firebaseUser);\r\n        setRole(isAdmin ? \"admin\" : \"user\");\r\n      } else {\r\n        setUser(null);\r\n        setRole(null);\r\n      }\r\n\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsub();\r\n  }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, role, loading }}>\r\n      {!loading && children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\n// -------------------------------------------------\r\n// HOOK\r\n// -------------------------------------------------\r\nexport function useAuth() {\r\n  return useContext(AuthContext);\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC7E,OAASC,IAAI,KAAQ,QAAQ,CAC7B,OACEC,kBAAkB,CAClBC,gBAAgB,KACX,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEvB,KAAM,CAAAC,WAAW,cAAGT,aAAa,CAAC,CAAC,CAEnC;AACA;AACA;AACA,MAAO,SAAS,CAAAU,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGX,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACY,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CAAE;AACxC,KAAM,CAACc,OAAO,CAAEC,UAAU,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAiB,KAAK,CAAGd,kBAAkB,CAACD,IAAI,CAAE,KAAO,CAAAgB,YAAY,EAAK,CAC7D,GAAIA,YAAY,CAAE,CAChB;AACA,KAAM,CAAAC,KAAK,CAAG,KAAM,CAAAf,gBAAgB,CAACc,YAAY,CAAC,CAClD,KAAM,CAAAE,OAAO,CAAGD,KAAK,CAACE,MAAM,CAACC,KAAK,GAAK,IAAI,CAE3CV,OAAO,CAACM,YAAY,CAAC,CACrBJ,OAAO,CAACM,OAAO,CAAG,OAAO,CAAG,MAAM,CAAC,CACrC,CAAC,IAAM,CACLR,OAAO,CAAC,IAAI,CAAC,CACbE,OAAO,CAAC,IAAI,CAAC,CACf,CAEAE,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CAEF,MAAO,IAAMC,KAAK,CAAC,CAAC,CACtB,CAAC,CAAE,EAAE,CAAC,CAEN,mBACEX,IAAA,CAACC,WAAW,CAACgB,QAAQ,EAACC,KAAK,CAAE,CAAEb,IAAI,CAAEE,IAAI,CAAEE,OAAQ,CAAE,CAAAL,QAAA,CAClD,CAACK,OAAO,EAAIL,QAAQ,CACD,CAAC,CAE3B,CAEA;AACA;AACA;AACA,MAAO,SAAS,CAAAe,OAAOA,CAAA,CAAG,CACxB,MAAO,CAAA1B,UAAU,CAACQ,WAAW,CAAC,CAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}