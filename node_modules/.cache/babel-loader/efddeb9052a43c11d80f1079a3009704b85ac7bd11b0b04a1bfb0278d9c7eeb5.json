{"ast":null,"code":"// src/firebase/uploadManager.js\n\nimport { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport { storage } from \"./config.js\";\nexport async function uploadChatAttachmentsWithProgress(threadId, files, onProgress) {\n  if (!threadId || !files || files.length === 0) return [];\n  const uploads = files.map((file, index) => new Promise((resolve, reject) => {\n    const safeName = file.name.replace(/\\s+/g, \"_\");\n    const path = `chatAttachments/${threadId}/${Date.now()}_${safeName}`;\n    const fileRef = ref(storage, path);\n    const task = uploadBytesResumable(fileRef, file);\n\n    // Progress tracking\n    task.on(\"state_changed\", snapshot => {\n      const percent = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n\n      // Send progress update to component\n      onProgress(index, percent);\n    }, reject, async () => {\n      const url = await getDownloadURL(task.snapshot.ref);\n      resolve({\n        url,\n        name: file.name,\n        contentType: file.type,\n        size: file.size\n      });\n    });\n  }));\n  return Promise.all(uploads);\n}","map":{"version":3,"names":["ref","uploadBytesResumable","getDownloadURL","storage","uploadChatAttachmentsWithProgress","threadId","files","onProgress","length","uploads","map","file","index","Promise","resolve","reject","safeName","name","replace","path","Date","now","fileRef","task","on","snapshot","percent","Math","round","bytesTransferred","totalBytes","url","contentType","type","size","all"],"sources":["C:/Users/Floyd/Desktop/Websites/HIAWTO/hi-awto-clean/src/firebase/uploadManager.js"],"sourcesContent":["// src/firebase/uploadManager.js\r\n\r\nimport { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\r\nimport { storage } from \"./config.js\";\r\n\r\nexport async function uploadChatAttachmentsWithProgress(threadId, files, onProgress) {\r\n  if (!threadId || !files || files.length === 0) return [];\r\n\r\n  const uploads = files.map(\r\n    (file, index) =>\r\n      new Promise((resolve, reject) => {\r\n        const safeName = file.name.replace(/\\s+/g, \"_\");\r\n        const path = `chatAttachments/${threadId}/${Date.now()}_${safeName}`;\r\n        const fileRef = ref(storage, path);\r\n\r\n        const task = uploadBytesResumable(fileRef, file);\r\n\r\n        // Progress tracking\r\n        task.on(\r\n          \"state_changed\",\r\n          (snapshot) => {\r\n            const percent = Math.round(\r\n              (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n            );\r\n\r\n            // Send progress update to component\r\n            onProgress(index, percent);\r\n          },\r\n          reject,\r\n          async () => {\r\n            const url = await getDownloadURL(task.snapshot.ref);\r\n            resolve({\r\n              url,\r\n              name: file.name,\r\n              contentType: file.type,\r\n              size: file.size,\r\n            });\r\n          }\r\n        );\r\n      })\r\n  );\r\n\r\n  return Promise.all(uploads);\r\n}\r\n"],"mappings":"AAAA;;AAEA,SAASA,GAAG,EAAEC,oBAAoB,EAAEC,cAAc,QAAQ,kBAAkB;AAC5E,SAASC,OAAO,QAAQ,aAAa;AAErC,OAAO,eAAeC,iCAAiCA,CAACC,QAAQ,EAAEC,KAAK,EAAEC,UAAU,EAAE;EACnF,IAAI,CAACF,QAAQ,IAAI,CAACC,KAAK,IAAIA,KAAK,CAACE,MAAM,KAAK,CAAC,EAAE,OAAO,EAAE;EAExD,MAAMC,OAAO,GAAGH,KAAK,CAACI,GAAG,CACvB,CAACC,IAAI,EAAEC,KAAK,KACV,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IAC/B,MAAMC,QAAQ,GAAGL,IAAI,CAACM,IAAI,CAACC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC;IAC/C,MAAMC,IAAI,GAAG,mBAAmBd,QAAQ,IAAIe,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIL,QAAQ,EAAE;IACpE,MAAMM,OAAO,GAAGtB,GAAG,CAACG,OAAO,EAAEgB,IAAI,CAAC;IAElC,MAAMI,IAAI,GAAGtB,oBAAoB,CAACqB,OAAO,EAAEX,IAAI,CAAC;;IAEhD;IACAY,IAAI,CAACC,EAAE,CACL,eAAe,EACdC,QAAQ,IAAK;MACZ,MAAMC,OAAO,GAAGC,IAAI,CAACC,KAAK,CACvBH,QAAQ,CAACI,gBAAgB,GAAGJ,QAAQ,CAACK,UAAU,GAAI,GACtD,CAAC;;MAED;MACAvB,UAAU,CAACK,KAAK,EAAEc,OAAO,CAAC;IAC5B,CAAC,EACDX,MAAM,EACN,YAAY;MACV,MAAMgB,GAAG,GAAG,MAAM7B,cAAc,CAACqB,IAAI,CAACE,QAAQ,CAACzB,GAAG,CAAC;MACnDc,OAAO,CAAC;QACNiB,GAAG;QACHd,IAAI,EAAEN,IAAI,CAACM,IAAI;QACfe,WAAW,EAAErB,IAAI,CAACsB,IAAI;QACtBC,IAAI,EAAEvB,IAAI,CAACuB;MACb,CAAC,CAAC;IACJ,CACF,CAAC;EACH,CAAC,CACL,CAAC;EAED,OAAOrB,OAAO,CAACsB,GAAG,CAAC1B,OAAO,CAAC;AAC7B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}