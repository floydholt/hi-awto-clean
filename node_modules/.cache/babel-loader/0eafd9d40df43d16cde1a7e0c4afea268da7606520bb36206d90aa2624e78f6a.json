{"ast":null,"code":"// src/firebase/listings.js\nimport { collection, addDoc, doc, getDoc, getDocs, updateDoc, deleteDoc, query, where, orderBy, serverTimestamp } from \"firebase/firestore\";\nimport { db, auth } from \"./config\";\nconst LISTINGS_COL = \"listings\";\n\n// Map a Firestore document snapshot into a plain JS object\nfunction mapDoc(docSnap) {\n  if (!docSnap.exists()) return null;\n  return {\n    id: docSnap.id,\n    ...docSnap.data()\n  };\n}\n\n// -----------------------------------------------------\n// CREATE\n// -----------------------------------------------------\nexport async function createListing(data) {\n  const user = auth.currentUser;\n  const ref = await addDoc(collection(db, LISTINGS_COL), {\n    ...data,\n    ownerId: user ? user.uid : null,\n    createdAt: serverTimestamp(),\n    updatedAt: serverTimestamp()\n  });\n  const snap = await getDoc(ref);\n  return mapDoc(snap);\n}\n\n// -----------------------------------------------------\n// READ – single listing\n// -----------------------------------------------------\nexport async function getListing(id) {\n  if (!id) return null;\n  const ref = doc(db, LISTINGS_COL, id);\n  const snap = await getDoc(ref);\n  return mapDoc(snap);\n}\n\n// Backwards-compatible alias (in case any file still imports this)\nexport const getListingById = getListing;\n\n// -----------------------------------------------------\n// READ – all listings (for public browsing / homepage)\n// -----------------------------------------------------\nexport async function getAllListings() {\n  const q = query(collection(db, LISTINGS_COL), orderBy(\"createdAt\", \"desc\"));\n  const snap = await getDocs(q);\n  return snap.docs.map(mapDoc);\n}\n\n// -----------------------------------------------------\n// READ – listings for the current user\n// -----------------------------------------------------\nexport async function getListingsForUser(userId) {\n  if (!userId) return [];\n  const q = query(collection(db, LISTINGS_COL), where(\"ownerId\", \"==\", userId), orderBy(\"createdAt\", \"desc\"));\n  const snap = await getDocs(q);\n  return snap.docs.map(mapDoc);\n}\n\n// -----------------------------------------------------\n// UPDATE\n// -----------------------------------------------------\nexport async function updateListing(id, data) {\n  if (!id) throw new Error(\"Missing listing id for update\");\n  const ref = doc(db, LISTINGS_COL, id);\n  await updateDoc(ref, {\n    ...data,\n    updatedAt: serverTimestamp()\n  });\n}\n\n// -----------------------------------------------------\n// DELETE\n// -----------------------------------------------------\nexport async function deleteListing(id) {\n  if (!id) return;\n  const ref = doc(db, LISTINGS_COL, id);\n  await deleteDoc(ref);\n}","map":{"version":3,"names":["collection","addDoc","doc","getDoc","getDocs","updateDoc","deleteDoc","query","where","orderBy","serverTimestamp","db","auth","LISTINGS_COL","mapDoc","docSnap","exists","id","data","createListing","user","currentUser","ref","ownerId","uid","createdAt","updatedAt","snap","getListing","getListingById","getAllListings","q","docs","map","getListingsForUser","userId","updateListing","Error","deleteListing"],"sources":["C:/Users/Floyd/Desktop/Websites/HIAWTO/hi-awto-clean/src/firebase/listings.js"],"sourcesContent":["// src/firebase/listings.js\r\nimport {\r\n  collection,\r\n  addDoc,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  updateDoc,\r\n  deleteDoc,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  serverTimestamp,\r\n} from \"firebase/firestore\";\r\nimport { db, auth } from \"./config\";\r\n\r\nconst LISTINGS_COL = \"listings\";\r\n\r\n// Map a Firestore document snapshot into a plain JS object\r\nfunction mapDoc(docSnap) {\r\n  if (!docSnap.exists()) return null;\r\n  return { id: docSnap.id, ...docSnap.data() };\r\n}\r\n\r\n// -----------------------------------------------------\r\n// CREATE\r\n// -----------------------------------------------------\r\nexport async function createListing(data) {\r\n  const user = auth.currentUser;\r\n  const ref = await addDoc(collection(db, LISTINGS_COL), {\r\n    ...data,\r\n    ownerId: user ? user.uid : null,\r\n    createdAt: serverTimestamp(),\r\n    updatedAt: serverTimestamp(),\r\n  });\r\n\r\n  const snap = await getDoc(ref);\r\n  return mapDoc(snap);\r\n}\r\n\r\n// -----------------------------------------------------\r\n// READ – single listing\r\n// -----------------------------------------------------\r\nexport async function getListing(id) {\r\n  if (!id) return null;\r\n  const ref = doc(db, LISTINGS_COL, id);\r\n  const snap = await getDoc(ref);\r\n  return mapDoc(snap);\r\n}\r\n\r\n// Backwards-compatible alias (in case any file still imports this)\r\nexport const getListingById = getListing;\r\n\r\n// -----------------------------------------------------\r\n// READ – all listings (for public browsing / homepage)\r\n// -----------------------------------------------------\r\nexport async function getAllListings() {\r\n  const q = query(\r\n    collection(db, LISTINGS_COL),\r\n    orderBy(\"createdAt\", \"desc\")\r\n  );\r\n  const snap = await getDocs(q);\r\n  return snap.docs.map(mapDoc);\r\n}\r\n\r\n// -----------------------------------------------------\r\n// READ – listings for the current user\r\n// -----------------------------------------------------\r\nexport async function getListingsForUser(userId) {\r\n  if (!userId) return [];\r\n  const q = query(\r\n    collection(db, LISTINGS_COL),\r\n    where(\"ownerId\", \"==\", userId),\r\n    orderBy(\"createdAt\", \"desc\")\r\n  );\r\n  const snap = await getDocs(q);\r\n  return snap.docs.map(mapDoc);\r\n}\r\n\r\n// -----------------------------------------------------\r\n// UPDATE\r\n// -----------------------------------------------------\r\nexport async function updateListing(id, data) {\r\n  if (!id) throw new Error(\"Missing listing id for update\");\r\n  const ref = doc(db, LISTINGS_COL, id);\r\n  await updateDoc(ref, {\r\n    ...data,\r\n    updatedAt: serverTimestamp(),\r\n  });\r\n}\r\n\r\n// -----------------------------------------------------\r\n// DELETE\r\n// -----------------------------------------------------\r\nexport async function deleteListing(id) {\r\n  if (!id) return;\r\n  const ref = doc(db, LISTINGS_COL, id);\r\n  await deleteDoc(ref);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}