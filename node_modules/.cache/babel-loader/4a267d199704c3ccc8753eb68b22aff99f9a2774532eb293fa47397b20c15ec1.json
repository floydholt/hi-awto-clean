{"ast":null,"code":"import React,{createContext,useContext,useEffect,useState}from\"react\";import{onAuthStateChanged}from\"firebase/auth\";import{doc,getDoc}from\"firebase/firestore\";import{auth,db}from\"./config\";import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);export function AuthProvider(_ref){let{children}=_ref;const[user,setUser]=useState(null);const[role,setRole]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const unsub=onAuthStateChanged(auth,async currentUser=>{setUser(currentUser);if(currentUser){const userRef=doc(db,\"users\",currentUser.uid);const snap=await getDoc(userRef);setRole(snap.exists()?snap.data().role:\"user\");}else{setRole(null);}setLoading(false);});return()=>unsub();},[]);return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{user,role,loading},children:children});}export function useAuth(){return useContext(AuthContext);}","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","onAuthStateChanged","doc","getDoc","auth","db","jsx","_jsx","AuthContext","AuthProvider","_ref","children","user","setUser","role","setRole","loading","setLoading","unsub","currentUser","userRef","uid","snap","exists","data","Provider","value","useAuth"],"sources":["C:/Users/Floyd/Desktop/Websites/HIAWTO/hi-awto-clean/src/firebase/AuthContext.jsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { onAuthStateChanged } from \"firebase/auth\";\r\nimport { doc, getDoc } from \"firebase/firestore\";\r\nimport { auth, db } from \"./config\";\r\n\r\nconst AuthContext = createContext(null);\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [role, setRole] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, async (currentUser) => {\r\n      setUser(currentUser);\r\n\r\n      if (currentUser) {\r\n        const userRef = doc(db, \"users\", currentUser.uid);\r\n        const snap = await getDoc(userRef);\r\n        setRole(snap.exists() ? snap.data().role : \"user\");\r\n      } else {\r\n        setRole(null);\r\n      }\r\n\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsub();\r\n  }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, role, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthContext);\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC7E,OAASC,kBAAkB,KAAQ,eAAe,CAClD,OAASC,GAAG,CAAEC,MAAM,KAAQ,oBAAoB,CAChD,OAASC,IAAI,CAAEC,EAAE,KAAQ,UAAU,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEpC,KAAM,CAAAC,WAAW,cAAGX,aAAa,CAAC,IAAI,CAAC,CAEvC,MAAO,SAAS,CAAAY,YAAYA,CAAAC,IAAA,CAAe,IAAd,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGb,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACc,IAAI,CAAEC,OAAO,CAAC,CAAGf,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAACgB,OAAO,CAAEC,UAAU,CAAC,CAAGjB,QAAQ,CAAC,IAAI,CAAC,CAE5CD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAmB,KAAK,CAAGjB,kBAAkB,CAACG,IAAI,CAAE,KAAO,CAAAe,WAAW,EAAK,CAC5DN,OAAO,CAACM,WAAW,CAAC,CAEpB,GAAIA,WAAW,CAAE,CACf,KAAM,CAAAC,OAAO,CAAGlB,GAAG,CAACG,EAAE,CAAE,OAAO,CAAEc,WAAW,CAACE,GAAG,CAAC,CACjD,KAAM,CAAAC,IAAI,CAAG,KAAM,CAAAnB,MAAM,CAACiB,OAAO,CAAC,CAClCL,OAAO,CAACO,IAAI,CAACC,MAAM,CAAC,CAAC,CAAGD,IAAI,CAACE,IAAI,CAAC,CAAC,CAACV,IAAI,CAAG,MAAM,CAAC,CACpD,CAAC,IAAM,CACLC,OAAO,CAAC,IAAI,CAAC,CACf,CAEAE,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAC,CAEF,MAAO,IAAMC,KAAK,CAAC,CAAC,CACtB,CAAC,CAAE,EAAE,CAAC,CAEN,mBACEX,IAAA,CAACC,WAAW,CAACiB,QAAQ,EAACC,KAAK,CAAE,CAAEd,IAAI,CAAEE,IAAI,CAAEE,OAAQ,CAAE,CAAAL,QAAA,CAClDA,QAAQ,CACW,CAAC,CAE3B,CAEA,MAAO,SAAS,CAAAgB,OAAOA,CAAA,CAAG,CACxB,MAAO,CAAA7B,UAAU,CAACU,WAAW,CAAC,CAChC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}